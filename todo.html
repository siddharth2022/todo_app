<html>
<head>
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
      
      
<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
<script>

</script>
</head>
<body>
<nav>
    <div class="nav-wrapper" style="text-align:center;font-size:25px;">
      MY TODO APP
    </div>
  
  
  </nav>
        
  <div class="row">
<div class="col s10 offset-s2">
<div class="row">

    <div class="col s8" id="main_todo">
      
    </div>
  </div>
  
  </div>
  
  <script>
  function get_data(){
$.get('http://localhost:8000/task/?format=json',function (data){
console.log(data);
var string='';
var status;
for(var i=0;i<data.length;i++)
{
if(data[i].mark_complete == '1') 
status="Complete";
 else 
 status="Pending";
string+=`<div class="card blue-grey darken-1"><div class="card-content white-text"><span class="card-title">Name:-  ${data[i].task_name}</span><span class="card-title">date:- ${data[i].closed_date}</span>
          <p>Deatil :- ${data[i].description}</p><p>status :- ${status}
        </div>
        <div class="card-action">
          <a class="waves-effect waves-light btn" onclick="update_apt(${data[i].id},'${data[i].task_name}',1,'${data[i].description}','${data[i].closed_date}')">Complete</a>
		  <a class="waves-effect waves-light btn" onclick="update_apt(${data[i].id},${data[i].task_name},${data[i].mark_complete},${data[i].description},${data[i].closed_date})">Update</a>
		  <a class="waves-effect waves-light btn" onclick="delete_apt(${data[i].id})">Delete</a>
        </div>
      </div>`;
}

document.getElementById('main_todo').innerHTML=string;
});
}
get_data();
function delete_apt(id)
{
	$.post("http://localhost:8000/task/",
  {
    mode: "2",
    id: id
  },
  function(data, status){
    
  });
  get_data();
}
function update_apt(id,task_name,mark,des,date1)
{
	$.post("http://localhost:8000/task/",
  {
    name: task_name,
	mark:mark,
	description:des,
	date:date1,
    id: id,
	mode:3
  },
  function(data, status){
    alert(data+status);
  });
  get_data();
  do_refresh();
}
function do_refresh()
{
get_data();
}
  </script>
</body>
</html>
